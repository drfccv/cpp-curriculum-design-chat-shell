# C语言课程设计 - 即时通讯系统 (OICQ)

## 📚 课程设计说明

这是一个**C语言课程设计项目**，实现了一个功能完整的单机即时通讯系统。项目采用C++语言开发，集成SQLite数据库，展示了面向对象编程、数据库设计、文件操作、内存管理等多个核心概念的综合应用。

### 🎯 设计目标
- 掌握C++面向对象编程思想
- 学习数据库设计与SQL操作
- 实践模块化程序设计
- 培养项目开发和文档编写能力

### 📋 技术栈
- **编程语言**: C++ (支持C++11标准)
- **数据库**: SQLite 3
- **开发工具**: GCC/MinGW编译器
- **构建系统**: Makefile, 批处理脚本

## 🌟 项目特色

- **完整的用户系统**：注册、登录、删除用户
- **智能聊天列表**：按时间排序显示最近聊天，支持自动刷新
- **多种聊天方式**：私聊、群聊功能完备
- **权限管理**：管理员密码保护的用户删除和群管理
- **跨平台支持**：Windows 和 Linux 兼容
- **UTF-8 支持**：完整的中文显示支持

## 📋 功能列表

### 用户管理
- ✅ 用户注册（用户名、密码）
- ✅ 用户登录
- ✅ 用户删除（需要管理员密码）
- ✅ 好友添加与管理

### 聊天功能
- ✅ 最近聊天列表（按时间排序）
- ✅ 私聊功能
- ✅ 群聊功能
- ✅ 聊天记录查看
- ✅ 实时消息刷新
- ✅ 智能时间显示（今天/历史日期）

### 群组管理
- ✅ 创建群组
- ✅ 加入群组
- ✅ 移除群成员（需要权限验证）

### 界面特性
- ✅ 清晰的菜单导航
- ✅ 自动清屏功能
- ✅ 用户友好的操作提示
- ✅ 错误处理和输入验证

## 🚀 快速开始

### 环境要求

- **编译器**：支持 C++11 的编译器
  - Windows: MinGW-w64 或 Visual Studio
  - Linux: GCC 4.8+ 或 Clang 3.3+
- **数据库**：内置 SQLite（无需额外安装）

### 编译方法

#### Windows (MinGW)
```bash
# 使用提供的批处理脚本
./build.bat

# 或手动编译
g++ -std=c++11 -I./include -I./include/sqlite -O2 -DUTF8_SUPPORT -finput-charset=UTF-8 -fexec-charset=UTF-8 -c include/sqlite/sqlite3.c -o sqlite3.o
g++ -std=c++11 -I./include -I./include/sqlite -O2 -DUTF8_SUPPORT -finput-charset=UTF-8 -fexec-charset=UTF-8 -c src/*.cpp
g++ -o oicq.exe *.o
```

#### Linux
```bash
# 使用提供的脚本
chmod +x build.sh
./build.sh

# 或使用 Makefile
make
```

### 运行程序

```bash
# Windows
./oicq.exe

# Linux
./oicq
```

## 📁 项目结构

```
oicq/                      # 项目根目录
├── src/                   # 源代码目录
│   ├── main.cpp          # 主程序入口，包含main函数
│   ├── ui.cpp            # 用户界面模块实现
│   ├── user.cpp          # 用户管理模块实现
│   ├── chat.cpp          # 聊天功能模块实现
│   └── database.cpp      # 数据库操作模块实现
├── include/              # 头文件目录
│   ├── ui.h             # 用户界面模块头文件
│   ├── user.h           # 用户管理模块头文件
│   ├── chat.h           # 聊天功能模块头文件
│   ├── database.h       # 数据库操作模块头文件
│   └── sqlite/          # SQLite数据库源码
│       ├── sqlite3.c    # SQLite实现源码
│       ├── sqlite3.h    # SQLite头文件
│       └── sqlite3ext.h # SQLite扩展头文件
├── obj/                 # 编译生成的目标文件目录
│   ├── main.o
│   ├── ui.o
│   ├── user.o
│   ├── chat.o
│   ├── database.o
│   └── sqlite3.o
├── database/            # 数据库相关文件
│   └── init.sql        # 数据库初始化SQL脚本
├── build.bat           # Windows批处理编译脚本
├── build.sh            # Linux shell编译脚本
├── Makefile            # Make构建文件
├── chat.db             # SQLite数据库文件（运行时生成）
├── oicq.exe            # Windows可执行文件（编译生成）
└── README.md           # 项目说明文档
```

## 🏗️ 课程设计架构

### 模块化设计
项目采用经典的模块化设计模式，每个功能模块职责明确：

1. **主控制模块** (`main.cpp`)
   - 程序入口点
   - 初始化系统
   - 主流程控制

2. **用户界面模块** (`ui.h/cpp`)
   - 菜单显示与交互
   - 输入输出处理
   - 界面美化

3. **用户管理模块** (`user.h/cpp`)
   - 用户注册与登录
   - 好友关系管理
   - 用户权限控制

4. **聊天功能模块** (`chat.h/cpp`)
   - 私聊与群聊实现
   - 消息发送接收
   - 聊天记录管理

5. **数据库操作模块** (`database.h/cpp`)
   - SQLite数据库封装
   - SQL语句执行
   - 数据持久化

## 🎯 使用指南

### 首次使用

1. **启动程序**：运行 `oicq.exe`
2. **注册用户**：选择"用户注册"创建账户
3. **登录系统**：使用注册的用户名和密码登录

### 基本操作

#### 添加好友
1. 登录后选择"添加好友"
2. 输入好友的用户名
3. 系统会验证用户是否存在并添加好友关系

#### 创建群组
1. 选择"创建群组"
2. 输入群组名称
3. 创建成功后自动成为群主

#### 开始聊天
1. 选择"聊天功能" → "最近聊天"
2. 选择要聊天的好友或群组
3. 输入消息，按回车发送
4. 输入 `exit` 退出当前聊天

### 管理功能

- **删除用户**：需要管理员密码（默认：admin123）
- **移除群成员**：群创建者或管理员权限

## 🔧 技术特性

### 数据库设计
- **users**: 用户信息表
- **friendships**: 好友关系表
- **groups**: 群组信息表  
- **group_members**: 群成员关系表
- **messages**: 消息记录表
- **system_config**: 系统配置表

### 安全特性
- 密码安全输入（隐藏显示）
- 管理员权限验证
- 输入验证和错误处理
- SQL 注入防护（参数化查询）

### 性能优化
- 消息记录限制（最近50条）
- 智能时间显示减少计算
- 内存管理优化
- 数据库连接复用

## 🛠️ 课程设计实现要点

### 核心技术应用

1. **面向对象编程**
   - 类的设计与实现
   - 封装、继承的应用
   - 构造函数与析构函数

2. **数据库编程**
   - SQL语句编写与执行
   - 数据库连接管理
   - 事务处理与错误处理

3. **文件操作**
   - 配置文件读写
   - 数据持久化存储
   - 文件系统交互

4. **内存管理**
   - 动态内存分配
   - 内存泄漏防护
   - 智能指针使用

5. **字符串处理**
   - C++字符串操作
   - 字符编码转换
   - 输入验证与过滤

### 编译环境配置

#### Windows环境 (推荐MinGW)
```bash
# 安装MinGW-w64
# 配置环境变量PATH
# 验证安装: gcc --version
```

#### Linux环境
```bash
# Ubuntu/Debian
sudo apt-get install build-essential
sudo apt-get install gcc g++

# CentOS/RHEL
sudo yum install gcc gcc-c++
```

### 编译构建系统

项目提供三种构建方式：

1. **批处理脚本** (Windows)
   ```bash
   build.bat
   ```

2. **Shell脚本** (Linux)
   ```bash
   chmod +x build.sh
   ./build.sh
   ```

3. **Makefile** (跨平台)
   ```bash
   make          # 编译
   make clean    # 清理
   make rebuild  # 重新编译
   ```

## 📝 课程设计总结与心得

### 项目收获
1. **编程技能提升**
   - 深入理解C++面向对象编程
   - 掌握SQLite数据库操作
   - 学会模块化程序设计

2. **工程实践能力**
   - 项目架构设计经验
   - 代码规范与文档编写
   - 调试与问题解决能力

3. **软件工程思想**
   - 需求分析与系统设计
   - 测试与维护意识
   - 用户体验设计考虑

### 技术难点与解决方案
- **字符编码问题**: 采用UTF-8编码统一处理中文显示
- **跨平台兼容**: 提供多种编译方式适配不同环境
- **数据库设计**: 合理的表结构设计确保数据一致性
- **内存管理**: 使用RAII机制避免内存泄漏

### 可扩展功能
- 网络通信功能(客户端-服务器架构)
- 图形用户界面(Qt/GTK)
- 消息加密与安全认证
- 文件传输功能
- 消息推送与通知

### 代码规范
- 采用驼峰命名法
- 4空格缩进
- 详细的函数注释
- 统一的错误处理机制

## 🎓 课程设计评价标准

### 功能完整性 (30%)
- ✅ 用户注册登录系统
- ✅ 好友管理功能
- ✅ 私聊功能实现
- ✅ 群聊功能实现
- ✅ 消息存储与查看

### 代码质量 (25%)
- ✅ 模块化设计清晰
- ✅ 面向对象编程规范
- ✅ 注释完整详细
- ✅ 错误处理完善
- ✅ 内存管理正确

### 数据库设计 (20%)
- ✅ 表结构设计合理
- ✅ SQL语句规范
- ✅ 数据一致性保证
- ✅ 索引优化

### 用户体验 (15%)
- ✅ 界面友好直观
- ✅ 操作流程顺畅
- ✅ 错误提示明确
- ✅ 中文显示正常

### 文档完整性 (10%)
- ✅ README文档详细
- ✅ 代码注释充分
- ✅ 编译说明清楚
- ✅ 使用指南完整

## 📊 项目统计

- **代码行数**: ~1500行C++代码
- **文件数量**: 13个源文件
- **功能模块**: 5个主要模块
- **数据库表**: 6个核心表
- **开发周期**: 建议2-3周

## 📚 参考资料

1. **C++编程**
   - C++ Primer 第五版
   - Effective C++ 第三版

2. **数据库设计**
   - SQLite官方文档
   - 数据库系统概念

3. **软件工程**
   - 代码大全 第二版
   - 重构：改善既有代码的设计

## 📋 提交清单

### 必需文件
- [ ] 完整源代码(src/, include/)
- [ ] 编译脚本(build.bat, build.sh, Makefile)  
- [ ] 项目文档(README.md)
- [ ] 数据库脚本(database/init.sql)
- [ ] 可执行文件(oicq.exe)

### 可选文件
- [ ] 课程设计报告(PDF格式)
- [ ] 演示视频或截图
- [ ] 测试用例文档
- [ ] 性能测试报告

## 📞 技术支持

### 项目信息
- **课程**: C语言程序设计课程设计
- **开发者**: drfccv
- **项目地址**: https://github.com/drfccv/cpp-curriculum-design-chat-shell
- **技术文档**: 详见本README文档

### 常见问题
1. **编译失败**: 检查编译器版本和环境配置
2. **中文乱码**: 确保终端支持UTF-8编码
3. **数据库错误**: 检查init.sql文件路径
4. **运行崩溃**: 在项目根目录下运行程序

---

**重要提示**: 
- 默认管理员密码: `admin123`
- 项目需在根目录运行
- 支持Windows和Linux平台
- 完整源码可用于学习和课程设计参考

### 快速开始
```bash
# 1. 克隆或下载项目
git clone https://github.com/drfccv/cpp-curriculum-design-chat-shell.git

# 2. 进入项目目录
cd cpp-curriculum-design-chat-shell

# 3. 编译程序 (Windows)
.\build.bat

# 4. 运行程序
.\oicq.exe

# 或者使用Makefile
make
./oicq
```